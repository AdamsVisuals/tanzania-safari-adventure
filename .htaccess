<IfModule mod_rewrite.c>
    RewriteEngine On

    # ----------------------------------------------------------------------
    # SECURITY: Prevent access to sensitive files
    # ----------------------------------------------------------------------
    RewriteRule ^(.git|.env|composer\.json|composer\.lock|error_log) - [R=404,NC,L]

    # ----------------------------------------------------------------------
    # FORCE HTTPS and NON-WWW (Recommended)
    # ----------------------------------------------------------------------
    RewriteCond %{HTTPS} off [OR]
    RewriteCond %{HTTP_HOST} ^www\.tanzania-safari-adventure\.com [NC]
    RewriteRule ^ https://tanzania-safari-adventure.com%{REQUEST_URI} [R=301,L,NE]

    # ----------------------------------------------------------------------
    # REDIRECTS: Clean up index and .html extensions
    # ----------------------------------------------------------------------
    # Redirect /index.html or /index to homepage
    RewriteCond %{THE_REQUEST} /index(\.html)? [NC]
    RewriteRule ^(.*)index(\.html)?$ /$1 [R=301,L]

    # Redirect .html URLs to clean version (e.g., /about.html â†’ /about)
    RewriteCond %{THE_REQUEST} \s/([^.]+)\.html [NC]
    RewriteRule ^ /%1 [R=301,L]

    # ----------------------------------------------------------------------
    # REWRITES: Internally map clean URLs to .html files
    # ----------------------------------------------------------------------
    # Serve .html files for clean URLs (e.g., /about serves /about.html)
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteCond %{REQUEST_FILENAME}\.html -f
    RewriteRule ^(.*)$ $1.html [L]

    # ----------------------------------------------------------------------
    # CACHING: Leverage Browser Caching
    # ----------------------------------------------------------------------
    <IfModule mod_expires.c>
        ExpiresActive On
        ExpiresDefault "access plus 1 hour"
        ExpiresByType text/html "access plus 0 seconds"
        ExpiresByType text/css "access plus 1 year"
        ExpiresByType application/javascript "access plus 1 year"
        ExpiresByType application/x-javascript "access plus 1 year"
        ExpiresByType image/jpg "access plus 1 month"
        ExpiresByType image/jpeg "access plus 1 month"
        ExpiresByType image/gif "access plus 1 month"
        ExpiresByType image/png "access plus 1 month"
        ExpiresByType image/svg+xml "access plus 1 month"
        ExpiresByType image/webp "access plus 1 month"
        ExpiresByType video/mp4 "access plus 1 month"
        ExpiresByType video/webm "access plus 1 month"
        ExpiresByType font/ttf "access plus 1 month"
        ExpiresByType font/otf "access plus 1 month"
        ExpiresByType font/woff "access plus 1 month"
        ExpiresByType font/woff2 "access plus 1 month"
        ExpiresByType application/font-woff "access plus 1 year"
        ExpiresByType image/x-icon "access plus 1 week"
        ExpiresByType application/xml "access plus 0 seconds"
        ExpiresByType application/json "access plus 0 seconds"
    </IfModule>

    # ----------------------------------------------------------------------
    # GZIP COMPRESSION: Reduce file sizes for faster transfers
    # ----------------------------------------------------------------------
    <IfModule mod_deflate.c>
        AddOutputFilterByType DEFLATE text/plain
        AddOutputFilterByType DEFLATE text/html
        AddOutputFilterByType DEFLATE text/xml
        AddOutputFilterByType DEFLATE text/css
        AddOutputFilterByType DEFLATE application/xml
        AddOutputFilterByType DEFLATE application/xhtml+xml
        AddOutputFilterByType DEFLATE application/rss+xml
        AddOutputFilterByType DEFLATE application/javascript
        AddOutputFilterByType DEFLATE application/x-javascript
        AddOutputFilterByType DEFLATE application/font-woff
        AddOutputFilterByType DEFLATE application/font-woff2
        AddOutputFilterByType DEFLATE image/svg+xml
    </IfModule>

    # ----------------------------------------------------------------------
    # SECURITY HEADERS: Protect your site from common vulnerabilities
    # ----------------------------------------------------------------------
    <IfModule mod_headers.c>
        Header always set X-Content-Type-Options "nosniff"
        Header always set X-XSS-Protection "1; mode=block"
        Header always set X-Frame-Options "SAMEORIGIN"
        Header always set Referrer-Policy "strict-origin-when-cross-origin"
        Header always set Permissions-Policy "geolocation=(), microphone=(), camera=()"
        Header always edit Set-Cookie (.*) "$1; Secure; HttpOnly; SameSite=Lax"
    </IfModule>
</IfModule>

# Custom Error Pages
ErrorDocument 404 /404.html
ErrorDocument 500 /500.html